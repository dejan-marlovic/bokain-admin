
<div *ngIf="bookingService.rebookBuffer != null" class="large-margin-bottom">
    <h1 class="no-margin">{{'rebook' | phrase}}</h1>
    <bo-booking-details [booking]="bookingService.rebookBuffer" [showActionButtons]="false"></bo-booking-details>
</div>

<material-tab-panel [activeTabIndex]="activeTabIndex" (tabChange)="activeTabIndex = $event.newIndex;">
    <!-- DAY -->
    <material-tab label="{{'day' | phrase}}">
        <div class="row">
            <div class="columns">
                <bo-day-stepper [(date)]="date"></bo-day-stepper>
            </div>
        </div>
        <!-- DAY BOOKING -->
        <div class="row" *ngIf="scheduleMode == false">
            <div class="columns">
                <bo-booking-add-day
                        [disabled]="calendarService.isLoading || bookingService.isLoading || salon == null || service == null"
                        [user]="user"
                        [salon]="salon"
                        [date]="date"
                        [totalDuration]="totalDuration"
                        (timeSelect)="onTimeSelect($event)">
                </bo-booking-add-day>
            </div>
        </div>

        <!-- DAY SCHEDULE -->
        <div class="row" *ngIf="scheduleMode == true">
            <div class="columns">
                <bo-schedule-day
                        [selectedState]="scheduleState"
                        [disabled]="calendarService.isLoading || bookingService.isLoading || user == null || salon == null"
                        [user]="user"
                        [salon]="salon"
                        [date]="date">
                </bo-schedule-day>
            </div>
        </div>
    </material-tab>

    <!-- WEEK -->
    <material-tab label="{{'week' | phrase}}">
        <div class="row">
            <div class="columns">
                <bo-week-stepper [(date)]="date"></bo-week-stepper>
            </div>
        </div>

        <!-- WEEK BOOKING -->
        <div class="row" *ngIf="scheduleMode == false">
            <div class="columns">
                <bo-booking-add-week
                        [disabled]="calendarService.isLoading || bookingService.isLoading || salon == null || service == null"
                        [user]="user"
                        [salon]="salon"
                        [totalDuration]="totalDuration"
                        [date]="date"
                        (dateClick)="openDayTab($event)"
                        (timeSelect)="onTimeSelect($event)">
                </bo-booking-add-week>
            </div>
        </div>

        <!-- WEEK SCHEDULE -->
        <div class="row" *ngIf="scheduleMode == true">
            <div class="columns">
                <bo-schedule-week
                        [selectedState]="scheduleState"
                        [disabled]="calendarService.isLoading || bookingService.isLoading || user == null || salon == null"
                        [user]="user"
                        [salon]="salon"
                        [date]="date"
                        (dateClick)="openDayTab($event)">
                </bo-schedule-week>
            </div>
        </div>
    </material-tab>

    <!-- MONTH -->
    <material-tab label="{{'month' | phrase}}">
        <bo-month-calendar
                [user]="user"
                [salon]="salon"
                [date]="date"
                (changeMonth)="date = $event"
                (dateClick)="openWeekTab($event)">
        </bo-month-calendar>
    </material-tab>
</material-tab-panel>

<fo-modal [title]="'new_booking' | phrase" [(visible)]="showBookingModal" [fixedWidth]="true" [fixedHeight]="true">
    <bo-new-booking [booking]="bufferBooking" (save)="onBookingDoneController.add($event)"></bo-new-booking>
</fo-modal>