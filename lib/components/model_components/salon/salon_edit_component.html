<div class="row">
    <div class="columns">
        <h2 class="text-center">[{{salon?.name}}]</h2>
    </div>
</div>

<div class="row" *ngIf="salon != null">
    <div class="columns">
        <material-tab-panel>
            <material-tab label="{{phrase.get(['salon_details'])}}">
                <form [ngFormModel]="details.form">
                    <bo-salon-details #details [salon]="salon"></bo-salon-details>
                    <div class="row">
                        <div class="columns">
                            <material-button
                                raised
                                [disabled]="salonService.isLoading"
                                (trigger)="save()">
                                {{phrase.get(['save'])}}
                            </material-button>
                            <material-button
                                raised
                                [disabled]="salonService.isLoading"
                                (trigger)="cancel()">
                                {{phrase.get(['cancel'])}}
                            </material-button>
                        </div>
                    </div>
                </form>
            </material-tab>
            <material-tab label="{{phrase.get(['booking_plural'])}}">
                <div>
                    <fo-data-table
                            [no-results-message]="phrase.get(['no_results'])"
                            [data]="salonBookings"
                            [disabled]="bookingService.isLoading"
                            [rows]="10"
                            [large-hidden-columns]="['salon_id']"
                            [medium-hidden-columns]="[phrase.get(['duration_minutes'])]"
                            [small-hidden-columns]="[phrase.get(['duration_minutes']), phrase.get(['user'])]"
                            (rowclick)="selectedBookingId = $event">
                    </fo-data-table>
                    <bo-booking-details [booking]="bookingService.getModel(selectedBookingId)"></bo-booking-details>
                </div>
            </material-tab>
            <material-tab label="{{phrase.get(['room_plural'])}}">
                <div class="row">
                    <div class="columns">
                        <div class="row">
                            <div class="columns">
                                <material-expansionpanel
                                        *ngFor="let roomId of salon.roomIds"
                                        flat
                                        [name]="salonService.getRoom(roomId).name"
                                        [showSaveCancel]="false">
                                    <div class="row">
                                        <div class="columns">
                                            <h2>{{phrase.get(['service_plural'])}}</h2>
                                            <bo-associative-table
                                                    [sourceData]="serviceService.getRows(null, true)"
                                                    [selectedIds]="salonService.getRoom(roomId).serviceIds"
                                                    (fo-select)="addRoomService(roomId, $event);"
                                                    (fo-unselect)="removeRoomService(roomId, $event);">
                                            </bo-associative-table>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="columns">
                                            <bo-status-select [status]="salonService.getRoom(roomId).status" (statusChange)="onStatusChange(roomId, $event)"></bo-status-select>
                                        </div>
                                    </div>
                                </material-expansionpanel>
                                <hr />
                            </div>
                        </div>
                        <div class="row">
                            <div class="large-4 medium-6 columns end">
                                <material-input
                                        type="text"
                                        floatingLabel
                                        foUppercase
                                        label="{{phrase.get(['name'])}}*"
                                        [maxCount]="100"
                                        [(ngModel)]="newRoomBuffer.name">
                                </material-input>
                            </div>
                        </div>
                        <div class="row">
                            <div class="columns">
                                <material-button
                                        raised
                                        (trigger)="createRoom()"
                                        [disabled]="newRoomBuffer.name.isEmpty">
                                    {{phrase.get(['add'])}}
                                </material-button>
                            </div>
                        </div>
                    </div>
                </div>
            </material-tab>
            <material-tab label="{{phrase.get(['user_plural'])}}">
                <div>
                    <bo-associative-table
                            [sourceData]="userService.getRows(null, true)"
                            [selectedIds]="salon.userIds"
                            (fo-select)="addUser($event)"
                            (fo-unselect)="removeUser($event)">
                    </bo-associative-table>
                </div>
            </material-tab>
        </material-tab-panel>
    </div>
</div>